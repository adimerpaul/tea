import{c as F,b6 as O,a7 as L,r as x,b7 as j,a as p,b8 as G,w as Q,J as z,h as f,am as h,d as W,U as m,g as K,x as J,_ as Y,Q as C,R as v,S as a,T as o,L as w,Y as V,aD as r,aB as X,aA as q,V as u,W as Z,b9 as E,aE as $,aF as ee}from"./index.b7b2c7ae.js";import{Q as te,a as y,c as b,d as A}from"./format.0b61551d.js";import{Q as le}from"./QList.873d9077.js";import{Q as ne}from"./QBtnGroup.1fa832ca.js";import{Q as oe,a as se,C as S}from"./ClosePopup.8f669294.js";import{Q as ae}from"./QTooltip.2c00b1da.js";import{Q as de,a as ie,b as ue}from"./QForm.767f4b62.js";import{Q as re}from"./QPage.90ac1732.js";import"./position-engine.dfe84533.js";const ce=Object.keys(O);function me(e){return ce.reduce((l,d)=>{const c=e[d];return c!==void 0&&(l[d]=c),l},{})}var fe=F({name:"QBtnDropdown",props:{...O,...L,modelValue:Boolean,split:Boolean,dropdownIcon:String,contentClass:[Array,String,Object],contentStyle:[Array,String,Object],cover:Boolean,persistent:Boolean,noRouteDismiss:Boolean,autoClose:Boolean,menuAnchor:{type:String,default:"bottom end"},menuSelf:{type:String,default:"top end"},menuOffset:Array,disableMainBtn:Boolean,disableDropdown:Boolean,noIconAnimation:Boolean,toggleAriaLabel:String},emits:["update:modelValue","click","beforeShow","show","beforeHide","hide"],setup(e,{slots:l,emit:d}){const{proxy:c}=K(),n=x(e.modelValue),i=x(null),t=j(),g=p(()=>{const s={"aria-expanded":n.value===!0?"true":"false","aria-haspopup":"true","aria-controls":t.value,"aria-label":e.toggleAriaLabel||c.$q.lang.label[n.value===!0?"collapse":"expand"](e.label)};return(e.disable===!0||e.split===!1&&e.disableMainBtn===!0||e.disableDropdown===!0)&&(s["aria-disabled"]="true"),s}),k=p(()=>"q-btn-dropdown__arrow"+(n.value===!0&&e.noIconAnimation===!1?" rotate-180":"")+(e.split===!1?" q-btn-dropdown__arrow-container":"")),D=p(()=>G(e)),I=p(()=>me(e));Q(()=>e.modelValue,s=>{i.value!==null&&i.value[s?"show":"hide"]()}),Q(()=>e.split,_);function R(s){n.value=!0,d("beforeShow",s)}function U(s){d("show",s),d("update:modelValue",!0)}function P(s){n.value=!1,d("beforeHide",s)}function N(s){d("hide",s),d("update:modelValue",!1)}function T(s){d("click",s)}function H(s){J(s),_(),d("click",s)}function M(s){i.value!==null&&i.value.toggle(s)}function B(s){i.value!==null&&i.value.show(s)}function _(s){i.value!==null&&i.value.hide(s)}return Object.assign(c,{show:B,hide:_,toggle:M}),z(()=>{e.modelValue===!0&&B()}),()=>{const s=[f(h,{class:k.value,name:e.dropdownIcon||c.$q.iconSet.arrow.dropdown})];return e.disableDropdown!==!0&&s.push(f(te,{ref:i,id:t.value,class:e.contentClass,style:e.contentStyle,cover:e.cover,fit:!0,persistent:e.persistent,noRouteDismiss:e.noRouteDismiss,autoClose:e.autoClose,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,separateClosePopup:!0,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,onBeforeShow:R,onShow:U,onBeforeHide:P,onHide:N},l.default)),e.split===!1?f(m,{class:"q-btn-dropdown q-btn-dropdown--simple",...I.value,...g.value,disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:T},{default:()=>W(l.label,[]).concat(s),loading:l.loading}):f(ne,{class:"q-btn-dropdown q-btn-dropdown--split no-wrap q-btn-item",rounded:e.rounded,square:e.square,...D.value,glossy:e.glossy,stretch:e.stretch},()=>[f(m,{class:"q-btn-dropdown--current",...I.value,disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1,onClick:H},{default:l.label,loading:l.loading}),f(m,{class:"q-btn-dropdown__arrow-container q-anchor--skip",...g.value,...D.value,disable:e.disable===!0||e.disableDropdown===!0,rounded:e.rounded,color:e.color,textColor:e.textColor,dense:e.dense,size:e.size,padding:e.padding,ripple:e.ripple},()=>s)])}}});const be={name:"StudentsIndex.vue",data(){return{cursos:["PREKINDER","KINDER","1ER BASICO","2DO BASICO","3ER BASICO","4TO BASICO","5TO BASICO","6TO BASICO","7MO BASICO","8VO BASICO","1ER SECUNDARIA","2DO SECUNDARIA","3ER SECUNDARIA","4TO SECUNDARIA"],columns:[{name:"option",label:"Opciones",align:"left",field:e=>e.option},{name:"id",label:"ID",align:"left",field:e=>e.id},{name:"rut",label:"Rut",align:"left",field:e=>e.rut},{name:"name",label:"Nombre",align:"left",field:e=>e.name},{name:"birthdate",label:"Fecha de Nacimiento",align:"left",field:e=>e.birthdate},{name:"year_PIE",label:"A\xF1o PIE",align:"left",field:e=>e.year_PIE},{name:"course",label:"Curso",align:"left",field:e=>e.course},{name:"year",label:"A\xF1o",align:"left",field:e=>e.year},{name:"address",label:"Direcci\xF3n",align:"left",field:e=>e.address},{name:"phone",label:"Celular",align:"left",field:e=>e.phone}],loading:!1,students:[],student:{},studentDialog:!1,clienDialogHistory:!1,filter:"",passwordShow:!1}},mounted(){this.studentGet()},methods:{studentSave(){this.loading=!0,this.student.id?this.$axios.put(`students/${this.student.id}`,this.student).then(e=>{this.studentDialog=!1;const l=this.students.findIndex(d=>d.id===this.student.id);this.students.splice(l,1,e.data)}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1}):this.$axios.post("students",this.student).then(e=>{this.studentDialog=!1,this.students.unshift(e.data)}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})},studentChangePassword(e){this.$alert.promptPassword("Ingrese la nueva contrase\xF1a").onOk(l=>{this.loading=!0,this.$axios.put(`passwordUpdate/${e.id}`,{password:l}).then(d=>{this.$alert.success("Contrase\xF1a cambiada con \xE9xito")}).catch(d=>{this.$alert.error(d.response.data.message)}).finally(()=>{this.loading=!1})})},studentHistory(e){this.$router.push("/students/history/"+e.id)},studentDelete(e){this.$alert.confirm("\xBFEst\xE1 seguro de eliminar este studente?").onOk(()=>{this.loading=!0,this.$axios.delete(`students/${e.id}`).then(l=>{const d=this.students.findIndex(c=>c.id===e.id);this.students.splice(d,1)}).catch(l=>{this.$alert.error(l.response.data.message)}).finally(()=>{this.loading=!1})})},studentEdit(e){this.studentDialog=!0,this.student={...e}},studentAdd(){this.studentDialog=!0,this.student={name:"",ci:"",birthdate:"",year_PIE:"",cource:"",year:"",address:"",phone:"",sex:"M"}},studentGet(){this.loading=!0,this.$axios.get("students").then(e=>{this.students=e.data}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})}}},ge={class:"text-h6"},he={class:"row"},pe={class:"col-12 col-md-4"},Ce={class:"col-12 col-md-8"},ve={class:"col-12 col-md-4"},we={class:"col-12 col-md-8"},Ve={class:"col-12 col-md-3"},Se={class:"col-12 col-md-3"},_e={class:"col-12 col-md-3"},ye={class:"col-12 col-md-3"},Ae={class:"col-12"},De={class:"col-12 col-md-6"},Ie={class:"col-12 col-md-6"};function Be(e,l,d,c,n,i){return C(),v(re,{class:"bg-grey-3 q-pa-md"},{default:a(()=>[o(se,{rows:n.students,columns:n.columns,title:"Clientes","rows-per-page-options":[0],"row-key":"id",dense:"",filter:n.filter,loading:n.loading},{"body-cell-option":a(t=>[o(oe,{"auto-width":""},{default:a(()=>[o(fe,{size:"sm",label:"Opciones","no-caps":"",color:"primary"},{default:a(()=>[o(le,null,{default:a(()=>[w((C(),v(y,{clickable:"",onClick:g=>i.studentEdit(t.row)},{default:a(()=>[o(b,{avatar:""},{default:a(()=>[o(h,{name:"edit"})]),_:1}),o(b,null,{default:a(()=>[o(A,null,{default:a(()=>[V("Editar")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[S]]),w((C(),v(y,{clickable:"",onClick:g=>i.studentDelete(t.row)},{default:a(()=>[o(b,{avatar:""},{default:a(()=>[o(h,{name:"delete"})]),_:1}),o(b,null,{default:a(()=>[o(A,null,{default:a(()=>[V("Eliminar")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[S]]),w((C(),v(y,{clickable:"",onClick:g=>i.studentHistory(t.row)},{default:a(()=>[o(b,{avatar:""},{default:a(()=>[o(h,{name:"history"})]),_:1}),o(b,null,{default:a(()=>[o(A,null,{default:a(()=>[V("Historial")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[S]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),"top-right":a(()=>[o(m,{outline:"",dense:"",icon:"add_circle",onClick:i.studentAdd,label:"Agregar","no-caps":"",loading:n.loading},{default:a(()=>[o(ae,null,{default:a(()=>[V("Agregar")]),_:1})]),_:1},8,["onClick","loading"]),o(r,{modelValue:n.filter,"onUpdate:modelValue":l[0]||(l[0]=t=>n.filter=t),dense:"",class:"q-ml-md",debounce:"300",placeholder:"Buscar",outlined:"",clearable:""},{append:a(()=>[o(h,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","columns","filter","loading"]),o(ee,{modelValue:n.studentDialog,"onUpdate:modelValue":l[14]||(l[14]=t=>n.studentDialog=t),persistent:""},{default:a(()=>[o(X,{style:{width:"750px","max-width":"90vw"}},{default:a(()=>[o(q,{class:"row items-center q-pb-none"},{default:a(()=>[u("div",ge,Z(n.student.id?"Editar":"Agregar")+" Estudiante",1),o(de),o(m,{flat:"",dense:"",icon:"close",onClick:l[1]||(l[1]=t=>n.studentDialog=!1)})]),_:1}),o(ie,{onSubmit:i.studentSave},{default:a(()=>[o(q,null,{default:a(()=>[u("div",he,[u("div",pe,[o(r,{modelValue:n.student.rut,"onUpdate:modelValue":l[2]||(l[2]=t=>n.student.rut=t),label:"Rut",outlined:"",dense:"",rules:[t=>!!t||"Campo requerido"]},null,8,["modelValue","rules"])]),u("div",Ce,[o(r,{modelValue:n.student.name,"onUpdate:modelValue":l[3]||(l[3]=t=>n.student.name=t),label:"Nombre Completo",outlined:"",dense:"",rules:[t=>!!t||"Campo requerido"]},null,8,["modelValue","rules"])]),u("div",ve,[o(r,{modelValue:n.student.tutorRut,"onUpdate:modelValue":l[4]||(l[4]=t=>n.student.tutorRut=t),label:"Rut Tutor",outlined:"",dense:"",rules:[t=>!!t||"Campo requerido"]},null,8,["modelValue","rules"])]),u("div",we,[o(r,{modelValue:n.student.tutorName,"onUpdate:modelValue":l[5]||(l[5]=t=>n.student.tutorName=t),label:"Nombre Completo Tutor",outlined:"",dense:"",rules:[t=>!!t||"Campo requerido"]},null,8,["modelValue","rules"])]),u("div",Ve,[o(r,{modelValue:n.student.birthdate,"onUpdate:modelValue":l[6]||(l[6]=t=>n.student.birthdate=t),label:"Fecha de Nacimiento",type:"date",outlined:"",dense:"",rules:[t=>!!t||"Campo requerido"]},null,8,["modelValue","rules"])]),u("div",Se,[o(r,{modelValue:n.student.year_PIE,"onUpdate:modelValue":l[7]||(l[7]=t=>n.student.year_PIE=t),label:"A\xF1o ingreso PIE",outlined:"",dense:"",rules:[t=>!!t||"Campo requerido"]},null,8,["modelValue","rules"])]),u("div",_e,[o(ue,{modelValue:n.student.course,"onUpdate:modelValue":l[8]||(l[8]=t=>n.student.course=t),label:"Curso",outlined:"",dense:"",options:n.cursos,rules:[t=>!!t||"Campo requerido"]},null,8,["modelValue","options","rules"])]),u("div",ye,[o(r,{modelValue:n.student.year,"onUpdate:modelValue":l[9]||(l[9]=t=>n.student.year=t),label:"A\xF1o",outlined:"",dense:"",rules:[t=>!!t||"Campo requerido"]},null,8,["modelValue","rules"])]),u("div",Ae,[o(r,{modelValue:n.student.address,"onUpdate:modelValue":l[10]||(l[10]=t=>n.student.address=t),label:"Direcci\xF3n",outlined:"",dense:"",rules:[t=>!!t||"Campo requerido"]},null,8,["modelValue","rules"])]),u("div",De,[o(r,{modelValue:n.student.phone,"onUpdate:modelValue":l[11]||(l[11]=t=>n.student.phone=t),type:"number",label:"Celular",outlined:"",dense:"",rules:[t=>!!t||"Campo requerido"]},null,8,["modelValue","rules"])]),u("div",Ie,[o(E,{modelValue:n.student.sex,"onUpdate:modelValue":l[12]||(l[12]=t=>n.student.sex=t),val:"M",label:"Masculino"},null,8,["modelValue"]),o(E,{modelValue:n.student.sex,"onUpdate:modelValue":l[13]||(l[13]=t=>n.student.sex=t),val:"F",label:"Femenino"},null,8,["modelValue"])])])]),_:1}),o($,{align:"right"},{default:a(()=>[w(o(m,{flat:"",label:"Cancelar",loading:n.loading},null,8,["loading"]),[[S]]),o(m,{color:"primary",label:"Guardar",type:"submit",loading:n.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}var Ne=Y(be,[["render",Be]]);export{Ne as default};
