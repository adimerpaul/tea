import{_ as D,Q as m,R as f,S as i,T as o,L as p,at as h,Y as c,U as b,aM as g,V as n,aN as k,W as x,aC as v,aB as y,aO as I,aP as S,a2 as _}from"./index.7943288a.js";import{a as C,b as u,d as w}from"./QMenu.342450a2.js";import{Q as U}from"./QBtnDropdown.34664eed.js";import{Q,a as q}from"./QTable.98522935.js";import{Q as B}from"./use-fullscreen.9549e3e0.js";import{Q as E}from"./QImg.9d8c8de1.js";import{Q as T}from"./format.b7c7748e.js";import{Q as N}from"./QSpace.7a353f3b.js";import{Q as A}from"./QForm.01b9666b.js";import{Q as O}from"./QPage.7f2c21d4.js";import{C as P}from"./ClosePopup.10a7b357.js";import"./QList.41d3c3b6.js";const L={name:"ColegiosIndex",data(){return{columns:[{name:"option",label:"Opciones",align:"left",field:e=>e.option},{name:"id",label:"ID",align:"left",field:e=>e.id},{name:"nombre",label:"Nombre",align:"left",field:e=>e.nombre},{name:"codigo",label:"C\xF3digo",align:"left",field:e=>e.codigo},{name:"logo",label:"Logo",align:"left",field:e=>e.logo},{name:"direccion",label:"Direcci\xF3n",align:"left",field:e=>e.direccion},{name:"telefono",label:"Tel\xE9fono",align:"left",field:e=>e.telefono},{name:"email",label:"Email",align:"left",field:e=>e.email}],loading:!1,colegios:[],colegio:{},colegioDialog:!1,clienDialogHistory:!1,filter:"",passwordShow:!1}},mounted(){this.colegioGet()},methods:{fotoColegio(e){this.$alert.prompt("Ingrese la URL de la foto").onOk(a=>{console.log(a),this.loading=!0;const s=new FormData;s.append("logo",a[0]),this.$axios.post(`fotoColegio/${e.id}`,s,{headers:{"Content-Type":"multipart/form-data"}}).then(r=>{this.$alert.success("Foto cambiada con \xE9xito");const t=this.colegios.find(d=>d.id===e.id);t.logo=r.data.logo}).catch(r=>{this.$alert.error(r.response.data.message)}).finally(()=>{this.loading=!1})})},colegioSave(){this.loading=!0,this.colegio.id?this.$axios.put(`colegios/${this.colegio.id}`,this.colegio).then(e=>{this.colegioDialog=!1;const a=this.colegios.findIndex(s=>s.id===this.colegio.id);this.colegios.splice(a,1,e.data)}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1}):this.$axios.post("colegios",this.colegio).then(e=>{this.colegioDialog=!1,this.colegios.unshift(e.data)}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})},colegioChangePassword(e){this.$alert.promptPassword("Ingrese la nueva contrase\xF1a").onOk(a=>{this.loading=!0,this.$axios.put(`passwordUpdate/${e.id}`,{password:a}).then(s=>{this.$alert.success("Contrase\xF1a cambiada con \xE9xito")}).catch(s=>{this.$alert.error(s.response.data.message)}).finally(()=>{this.loading=!1})})},colegioDelete(e){this.$alert.confirm("\xBFEst\xE1 seguro de eliminar este colegioe?").onOk(()=>{this.loading=!0,this.$axios.delete(`colegios/${e.id}`).then(a=>{const s=this.colegios.findIndex(r=>r.id===e.id);this.colegios.splice(s,1)}).catch(a=>{this.$alert.error(a.response.data.message)}).finally(()=>{this.loading=!1})})},colegioEdit(e){this.colegioDialog=!0,this.colegio={...e}},colegioAdd(){this.colegioDialog=!0,this.colegio={name:"",codigo:"",direccion:"",telefono:"",email:""}},colegioGet(){this.loading=!0,this.$axios.get("colegios").then(e=>{this.colegios=e.data}).catch(e=>{this.$alert.error(e.response.data.message)}).finally(()=>{this.loading=!1})}}},R=["href"],$={class:"text-h6"},F={class:"row"},G={class:"col-12"},z={class:"col-12"},H={class:"col-12"},M={class:"col-12"},W={class:"col-12"};function Y(e,a,s,r,t,d){return m(),f(O,{class:"bg-grey-3 q-pa-md"},{default:i(()=>[o(q,{rows:t.colegios,columns:t.columns,title:"Colegios","rows-per-page-options":[0],"row-key":"id",dense:"",filter:t.filter,loading:t.loading,"wrap-cells":"","no-data-label":"No hay datos"},{"body-cell-option":i(l=>[o(Q,{"auto-width":""},{default:i(()=>[o(U,{label:"Opciones",color:"primary","auto-close":"","no-caps":"",size:"10px"},{default:i(()=>[p((m(),f(C,{clickable:"",onClick:V=>d.colegioEdit(l.row)},{default:i(()=>[o(u,{avatar:""},{default:i(()=>[o(h,{name:"edit"})]),_:1}),o(u,null,{default:i(()=>[o(w,null,{default:i(()=>[c("Editar")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[_]]),p((m(),f(C,{clickable:"",onClick:V=>d.colegioDelete(l.row)},{default:i(()=>[o(u,{avatar:""},{default:i(()=>[o(h,{name:"delete"})]),_:1}),o(u,null,{default:i(()=>[o(w,null,{default:i(()=>[c("Eliminar")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[_]]),p((m(),f(C,{clickable:"",onClick:V=>d.fotoColegio(l.row)},{default:i(()=>[o(u,{avatar:""},{default:i(()=>[o(h,{name:"image"})]),_:1}),o(u,null,{default:i(()=>[o(w,null,{default:i(()=>[c("Cambio de foto")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[_]])]),_:2},1024)]),_:2},1024)]),"top-right":i(()=>[o(b,{outline:"",dense:"",icon:"add_circle",onClick:d.colegioAdd,label:"Agregar","no-caps":"",loading:t.loading},{default:i(()=>[o(B,null,{default:i(()=>[c("Agregar")]),_:1})]),_:1},8,["onClick","loading"]),o(g,{modelValue:t.filter,"onUpdate:modelValue":a[0]||(a[0]=l=>t.filter=l),dense:"",class:"q-ml-md",debounce:"300",placeholder:"Buscar",outlined:"",clearable:""},{append:i(()=>[o(h,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-logo":i(l=>[o(Q,{"auto-width":""},{default:i(()=>[n("a",{href:e.$url+"../imagenes/"+l.row.logo,target:"_blank"},[o(E,{src:e.$url+"../imagenes/"+l.row.logo,style:{width:"50px",height:"50px"}},null,8,["src"])],8,R)]),_:2},1024)]),"body-cell-nombre":i(l=>[o(Q,{"auto-width":""},{default:i(()=>[o(T,{dense:"","text-color":"white",style:k(`background-color: #${l.row.color}`)},{default:i(()=>[c(x(l.row.nombre),1)]),_:2},1032,["style"])]),_:2},1024)]),default:i(()=>[c(" > ")]),_:1},8,["rows","columns","filter","loading"]),o(S,{modelValue:t.colegioDialog,"onUpdate:modelValue":a[7]||(a[7]=l=>t.colegioDialog=l),persistent:""},{default:i(()=>[o(v,{style:{width:"250px","max-width":"90vw"}},{default:i(()=>[o(y,{class:"row items-center q-pb-none"},{default:i(()=>[n("div",$,x(t.colegio.id?"Editar":"Agregar")+" Colegio",1),o(N),o(b,{flat:"",dense:"",icon:"close",onClick:a[1]||(a[1]=l=>t.colegioDialog=!1)})]),_:1}),o(A,{onSubmit:d.colegioSave},{default:i(()=>[o(y,null,{default:i(()=>[n("div",F,[n("div",G,[o(g,{modelValue:t.colegio.nombre,"onUpdate:modelValue":a[2]||(a[2]=l=>t.colegio.nombre=l),label:"Nombre",outlined:"",dense:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"])]),n("div",z,[o(g,{modelValue:t.colegio.codigo,"onUpdate:modelValue":a[3]||(a[3]=l=>t.colegio.codigo=l),label:"RBD",outlined:"",dense:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"])]),n("div",H,[o(g,{modelValue:t.colegio.direccion,"onUpdate:modelValue":a[4]||(a[4]=l=>t.colegio.direccion=l),label:"Direcci\xF3n",outlined:"",dense:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"])]),n("div",M,[o(g,{modelValue:t.colegio.telefono,"onUpdate:modelValue":a[5]||(a[5]=l=>t.colegio.telefono=l),label:"Tel\xE9fono",outlined:"",dense:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"])]),n("div",W,[o(g,{modelValue:t.colegio.email,"onUpdate:modelValue":a[6]||(a[6]=l=>t.colegio.email=l),label:"Email",outlined:"",dense:"",rules:[l=>!!l||"Campo requerido"]},null,8,["modelValue","rules"])])])]),_:1}),o(I,{align:"right"},{default:i(()=>[p(o(b,{flat:"",label:"Cancelar",loading:t.loading},null,8,["loading"]),[[P]]),o(b,{color:"primary",label:"Guardar",type:"submit",loading:t.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}var ne=D(L,[["render",Y]]);export{ne as default};
