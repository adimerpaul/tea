import{Q as c}from"./QTooltip.d48ad3bf.js";import{_ as x,Q as n,R as d,S as a,T as s,U as t,Y as p,Z as f,aD as h,am as C,aB as y,aA as _,V as u,W as V,aE as D,L as k,aF as Q}from"./index.6cfafacc.js";import{Q as v,a as A}from"./QTable.b6345fa5.js";import{e as g}from"./format.0f6b8801.js";import{Q as T,a as S,b as E,C as U}from"./ClosePopup.b7f8099f.js";import{Q as I}from"./QPage.1722d5fe.js";import"./position-engine.9cf8183c.js";import"./QList.f814039d.js";const N={name:"ClientsIndex",data(){return{columns:[{name:"option",label:"Opciones",align:"left",field:l=>l.option},{name:"id",label:"ID",align:"left",field:l=>l.id},{name:"name",label:"Nombre",align:"left",field:l=>l.name},{name:"username",label:"Usuario",align:"left",field:l=>l.username},{name:"role",label:"Rol",align:"left",field:l=>l.role}],loading:!1,users:[],user:{},userDialog:!1,clienDialogHistory:!1,filter:"",passwordShow:!1}},mounted(){this.userGet()},methods:{userSave(){this.loading=!0,this.user.id?this.$axios.put(`users/${this.user.id}`,this.user).then(l=>{this.userDialog=!1;const r=this.users.findIndex(i=>i.id===this.user.id);this.users.splice(r,1,l.data)}).catch(l=>{this.$alert.error(l.response.data.message)}).finally(()=>{this.loading=!1}):this.$axios.post("users",this.user).then(l=>{this.userDialog=!1,this.users.unshift(l.data)}).catch(l=>{this.$alert.error(l.response.data.message)}).finally(()=>{this.loading=!1})},userChangePassword(l){this.$alert.promptPassword("Ingrese la nueva contrase\xF1a").onOk(r=>{this.loading=!0,this.$axios.put(`passwordUpdate/${l.id}`,{password:r}).then(i=>{this.$alert.success("Contrase\xF1a cambiada con \xE9xito")}).catch(i=>{this.$alert.error(i.response.data.message)}).finally(()=>{this.loading=!1})})},userDelete(l){this.$alert.confirm("\xBFEst\xE1 seguro de eliminar este usere?").onOk(()=>{this.loading=!0,this.$axios.delete(`users/${l.id}`).then(r=>{const i=this.users.findIndex(w=>w.id===w.id);this.users.splice(i,1)}).catch(r=>{this.$alert.error(r.response.data.message)}).finally(()=>{this.loading=!1})})},userEdit(l){this.userDialog=!0,this.user={...l}},userAdd(){this.userDialog=!0,this.user={name:"",ci:""}},userGet(){this.loading=!0,this.$axios.get("users").then(l=>{this.users=l.data}).catch(l=>{this.$alert.error(l.response.data.message)}).finally(()=>{this.loading=!1})}}},O={class:"text-h6"},R={class:"row"},q={class:"col-12"},P={class:"col-12"},B={class:"col-12"},G={class:"col-12"};function H(l,r,i,w,o,m){return n(),d(I,{class:"bg-grey-3 q-pa-md"},{default:a(()=>[s(A,{rows:o.users,columns:o.columns,title:"Clientes","rows-per-page-options":[0],"row-key":"id",dense:"",filter:o.filter,loading:o.loading},{"body-cell-option":a(e=>[s(v,{"auto-width":""},{default:a(()=>[s(t,{flat:"",dense:"",icon:"edit",onClick:b=>m.userEdit(e.row)},{default:a(()=>[s(c,null,{default:a(()=>[p("Editar")]),_:1})]),_:2},1032,["onClick"]),s(t,{flat:"",dense:"",icon:"delete",onClick:b=>m.userDelete(e.row)},{default:a(()=>[s(c,null,{default:a(()=>[p("Eliminar")]),_:1})]),_:2},1032,["onClick"]),s(t,{flat:"",dense:"",icon:"vpn_key",onClick:b=>m.userChangePassword(e.row)},{default:a(()=>[s(c,null,{default:a(()=>[p("Cambiar Contrase\xF1a")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),"body-cell-role":a(e=>[s(v,{props:e},{default:a(()=>[e.row.role==="ADMIN"?(n(),d(g,{key:0,dense:"",label:"Admin",color:"primary","text-color":"white"})):f("",!0),e.row.role==="ATTORNEY"?(n(),d(g,{key:1,dense:"",label:"Tutor",color:"indigo","text-color":"white"})):f("",!0),e.row.role==="TEACHER"?(n(),d(g,{key:2,dense:"",label:"Profesor",color:"green","text-color":"white"})):f("",!0),e.row.role==="DOCTOR"?(n(),d(g,{key:3,dense:"",label:"Doctor",color:"red","text-color":"white"})):f("",!0)]),_:2},1032,["props"])]),"top-right":a(()=>[s(t,{outline:"",dense:"",icon:"add_circle",onClick:m.userAdd,label:"Agregar","no-caps":"",loading:o.loading},{default:a(()=>[s(c,null,{default:a(()=>[p("Agregar")]),_:1})]),_:1},8,["onClick","loading"]),s(h,{modelValue:o.filter,"onUpdate:modelValue":r[0]||(r[0]=e=>o.filter=e),dense:"",class:"q-ml-md",debounce:"300",placeholder:"Buscar",outlined:"",clearable:""},{append:a(()=>[s(C,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","columns","filter","loading"]),s(Q,{modelValue:o.userDialog,"onUpdate:modelValue":r[7]||(r[7]=e=>o.userDialog=e),persistent:""},{default:a(()=>[s(y,{style:{width:"250px","max-width":"90vw"}},{default:a(()=>[s(_,{class:"row items-center q-pb-none"},{default:a(()=>[u("div",O,V(o.user.id?"Editar":"Agregar")+" Cliente",1),s(T),s(t,{flat:"",dense:"",icon:"close",onClick:r[1]||(r[1]=e=>o.userDialog=!1)})]),_:1}),s(S,{onSubmit:m.userSave},{default:a(()=>[s(_,null,{default:a(()=>[u("div",R,[u("div",q,[s(h,{modelValue:o.user.name,"onUpdate:modelValue":r[2]||(r[2]=e=>o.user.name=e),label:"Nombre",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),u("div",P,[s(h,{modelValue:o.user.username,"onUpdate:modelValue":r[3]||(r[3]=e=>o.user.username=e),label:"Usuario",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),u("div",B,[o.user.id?f("",!0):(n(),d(h,{key:0,modelValue:o.user.password,"onUpdate:modelValue":r[5]||(r[5]=e=>o.user.password=e),label:"Contrase\xF1a",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"],type:o.passwordShow?"text":"password"},{append:a(()=>[s(C,{name:o.passwordShow?"visibility":"visibility_off",onClick:r[4]||(r[4]=e=>o.passwordShow=!o.passwordShow)},null,8,["name"])]),_:1},8,["modelValue","rules","type"]))]),u("div",G,[s(E,{modelValue:o.user.role,"onUpdate:modelValue":r[6]||(r[6]=e=>o.user.role=e),label:"Rol",outlined:"",dense:"",options:[{label:"Admin",value:"ADMIN"},{label:"Tutor",value:"ATTORNEY"},{label:"Profesor",value:"TEACHER"},{label:"Doctor",value:"DOCTOR"}],rules:[e=>!!e||"Campo requerido"],"emit-value":"","map-options":""},null,8,["modelValue","rules"])])])]),_:1}),s(D,{align:"right"},{default:a(()=>[k(s(t,{flat:"",label:"Cancelar",loading:o.loading},null,8,["loading"]),[[U]]),s(t,{color:"primary",label:"Guardar",type:"submit",loading:o.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}var J=x(N,[["render",H]]);export{J as default};
