import{_ as S,Q as p,R as g,S as d,T as l,L as h,at as b,Y as f,U as C,aM as i,V as n,aN as A,W as I,aC as E,aB as w,bc as x,aO as k,aP as U,a2 as O}from"./index.7144629d.js";import{a as V,b as u,d as _}from"./QMenu.13a81b90.js";import{Q as R}from"./QList.162f82a2.js";import{Q as N}from"./QBtnDropdown.f3428492.js";import{Q as y,a as q}from"./QTable.4f15cf0f.js";import{Q as B}from"./use-fullscreen.121d338a.js";import{Q as T}from"./QImg.e598c592.js";import{Q as F}from"./format.2edcade7.js";import{Q as P}from"./QSpace.be318dcd.js";import{Q as G,a as D}from"./QForm.4cf33053.js";import{Q as M}from"./QPage.052008f4.js";import{C as v}from"./ClosePopup.8dafc580.js";const L={name:"StudentsIndex.vue",data(){return{cursos:["PREKINDER","KINDER","1ER BASICO","2DO BASICO","3ER BASICO","4TO BASICO","5TO BASICO","6TO BASICO","7MO BASICO","8VO BASICO","1ER SECUNDARIA","2DO SECUNDARIA","3ER SECUNDARIA","4TO SECUNDARIA"],columns:[{name:"id",label:"ID",align:"left",field:s=>s.id},{name:"rut",label:"Rut",align:"left",field:s=>s.rut},{name:"name",label:"Nombre",align:"left",field:s=>s.name},{name:"email",label:"Email",align:"left",field:s=>s.email},{name:"foto",label:"Foto",align:"left",field:s=>s.foto},{name:"phone",label:"Celular",align:"left",field:s=>s.phone},{name:"colegio",label:"Colegio",align:"left",field:s=>{var t;return(t=s.colegio)==null?void 0:t.nombre}},{name:"option",label:"Opciones",align:"left",field:s=>s.option}],loading:!1,students:[],student:{},studentDialog:!1,clienDialogHistory:!1,filter:"",passwordShow:!1,colegios:[]}},mounted(){this.studentGet(),this.colegiosGet()},methods:{colegiosGet(){this.loading=!0,this.$axios.get("colegios").then(s=>{this.colegios=s.data}).catch(s=>{this.$alert.error(s.response.data.message)}).finally(()=>{this.loading=!1})},studentSave(){this.loading=!0,this.student.id?this.$axios.put(`students/${this.student.id}`,this.student).then(s=>{this.studentDialog=!1;const t=this.students.findIndex(r=>r.id===this.student.id);this.students.splice(t,1,s.data)}).catch(s=>{this.$alert.error(s.response.data.message)}).finally(()=>{this.loading=!1}):this.$axios.post("students",this.student).then(s=>{this.studentDialog=!1,this.students.unshift(s.data)}).catch(s=>{this.$alert.error(s.response.data.message)}).finally(()=>{this.loading=!1})},fotoColegio(s){this.$alert.prompt("Ingrese la URL de la foto").onOk(t=>{console.log(t),this.loading=!0;const r=new FormData;r.append("file",t[0]),this.$axios.post(`fotoStudent/${s.id}`,r,{headers:{"Content-Type":"multipart/form-data"}}).then(m=>{this.$alert.success("Foto cambiada con \xE9xito");const o=this.students.find(a=>a.id===s.id);o.logo=m.data.logo}).catch(m=>{this.$alert.error(m.response.data.message)}).finally(()=>{this.loading=!1})})},studentHistory(s){this.$router.push("/students/history/"+s.id)},studentDelete(s){this.$alert.confirm("\xBFEst\xE1 seguro de eliminar este studente?").onOk(()=>{this.loading=!0,this.$axios.delete(`students/${s.id}`).then(t=>{const r=this.students.findIndex(m=>m.id===s.id);this.students.splice(r,1)}).catch(t=>{this.$alert.error(t.response.data.message)}).finally(()=>{this.loading=!1})})},studentEdit(s){this.studentDialog=!0,this.student={...s}},studentAdd(){this.studentDialog=!0,this.student={name:"",ci:"",birthdate:"",year_PIE:"",cource:"",year:"",address:"",phone:"",sex:"M"}},studentGet(){this.loading=!0,this.$axios.get("students").then(s=>{this.students=s.data}).catch(s=>{this.$alert.error(s.response.data.message)}).finally(()=>{this.loading=!1})}}},H=["href"],z={class:"text-h6"},K={class:"row"},W={class:"col-12 col-md-4"},Y={class:"col-12 col-md-8"},j={class:"col-12 col-md-4"},J={class:"col-12 col-md-8"},X={class:"col-12 col-md-3"},Z={class:"col-12 col-md-3"},$={class:"col-12 col-md-3"},ee={class:"col-12 col-md-3"},le={class:"col-12 col-md-9"},te={class:"col-12 col-md-3"},oe={class:"col-12 col-md-4"},se={class:"col-12 col-md-4"},de={class:"col-12 col-md-4"};function ne(s,t,r,m,o,a){return p(),g(M,{class:"bg-grey-3 q-pa-md"},{default:d(()=>[l(q,{rows:o.students,columns:o.columns,title:"Estudiantes","rows-per-page-options":[0],"row-key":"id",dense:"",filter:o.filter,loading:o.loading,"wrap-cells":""},{"body-cell-option":d(e=>[l(y,{"auto-width":""},{default:d(()=>[l(N,{size:"sm",label:"Opciones","no-caps":"",color:"primary"},{default:d(()=>[l(R,null,{default:d(()=>[h((p(),g(V,{clickable:"",onClick:c=>a.studentEdit(e.row)},{default:d(()=>[l(u,{avatar:""},{default:d(()=>[l(b,{name:"edit"})]),_:1}),l(u,null,{default:d(()=>[l(_,null,{default:d(()=>[f("Editar")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[v]]),h((p(),g(V,{clickable:"",onClick:c=>a.studentDelete(e.row)},{default:d(()=>[l(u,{avatar:""},{default:d(()=>[l(b,{name:"delete"})]),_:1}),l(u,null,{default:d(()=>[l(_,null,{default:d(()=>[f("Eliminar")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[v]]),h((p(),g(V,{clickable:"",onClick:c=>a.studentHistory(e.row)},{default:d(()=>[l(u,{avatar:""},{default:d(()=>[l(b,{name:"history"})]),_:1}),l(u,null,{default:d(()=>[l(_,null,{default:d(()=>[f("Ficha")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[v]]),h((p(),g(V,{clickable:"",onClick:c=>a.fotoColegio(e.row)},{default:d(()=>[l(u,{avatar:""},{default:d(()=>[l(b,{name:"image"})]),_:1}),l(u,null,{default:d(()=>[l(_,null,{default:d(()=>[f("Cambio de foto")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[O]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),"top-right":d(()=>[l(C,{outline:"",dense:"",icon:"add_circle",onClick:a.studentAdd,label:"Agregar","no-caps":"",loading:o.loading},{default:d(()=>[l(B,null,{default:d(()=>[f("Agregar")]),_:1})]),_:1},8,["onClick","loading"]),l(i,{modelValue:o.filter,"onUpdate:modelValue":t[0]||(t[0]=e=>o.filter=e),dense:"",class:"q-ml-md",debounce:"300",placeholder:"Buscar",outlined:"",clearable:""},{append:d(()=>[l(b,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-foto":d(e=>[l(y,{"auto-width":""},{default:d(()=>[n("a",{href:s.$url+"../students/"+e.row.foto,target:"_blank"},[l(T,{src:s.$url+"../students/"+e.row.foto,style:{width:"50px",height:"50px"}},null,8,["src"])],8,H)]),_:2},1024)]),"body-cell-colegio":d(e=>[l(y,{"auto-width":""},{default:d(()=>{var c;return[l(F,{dense:"","text-color":"white",style:A(`background-color: #${(c=e.row.colegio)==null?void 0:c.color}`)},{default:d(()=>{var Q;return[f(I((Q=e.row.colegio)==null?void 0:Q.nombre),1)]}),_:2},1032,["style"])]}),_:2},1024)]),_:1},8,["rows","columns","filter","loading"]),l(U,{modelValue:o.studentDialog,"onUpdate:modelValue":t[16]||(t[16]=e=>o.studentDialog=e),persistent:""},{default:d(()=>[l(E,{style:{width:"750px","max-width":"90vw"}},{default:d(()=>[l(w,{class:"row items-center q-pb-none"},{default:d(()=>[n("div",z,I(o.student.id?"Editar":"Agregar")+" Estudiante",1),l(P),l(C,{flat:"",dense:"",icon:"close",onClick:t[1]||(t[1]=e=>o.studentDialog=!1)})]),_:1}),l(G,{onSubmit:a.studentSave},{default:d(()=>[l(w,null,{default:d(()=>[n("div",K,[n("div",W,[l(i,{modelValue:o.student.rut,"onUpdate:modelValue":t[2]||(t[2]=e=>o.student.rut=e),label:"Rut",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),n("div",Y,[l(i,{modelValue:o.student.name,"onUpdate:modelValue":t[3]||(t[3]=e=>o.student.name=e),label:"Nombre Completo",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),n("div",j,[l(i,{modelValue:o.student.tutorRut,"onUpdate:modelValue":t[4]||(t[4]=e=>o.student.tutorRut=e),label:"Rut Tutor",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),n("div",J,[l(i,{modelValue:o.student.tutorName,"onUpdate:modelValue":t[5]||(t[5]=e=>o.student.tutorName=e),label:"Nombre Completo Tutor",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),n("div",X,[l(i,{modelValue:o.student.birthdate,"onUpdate:modelValue":t[6]||(t[6]=e=>o.student.birthdate=e),label:"Fecha de Nacimiento",type:"date",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),n("div",Z,[l(i,{modelValue:o.student.year_PIE,"onUpdate:modelValue":t[7]||(t[7]=e=>o.student.year_PIE=e),label:"A\xF1o ingreso PIE",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),n("div",$,[l(D,{modelValue:o.student.course,"onUpdate:modelValue":t[8]||(t[8]=e=>o.student.course=e),label:"Curso",outlined:"",dense:"",options:o.cursos,rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","options","rules"])]),n("div",ee,[l(i,{modelValue:o.student.year,"onUpdate:modelValue":t[9]||(t[9]=e=>o.student.year=e),label:"A\xF1o",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),n("div",le,[l(i,{modelValue:o.student.address,"onUpdate:modelValue":t[10]||(t[10]=e=>o.student.address=e),label:"Direcci\xF3n",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),n("div",te,[l(D,{modelValue:o.student.colegio_id,"onUpdate:modelValue":t[11]||(t[11]=e=>o.student.colegio_id=e),label:"Colegio",outlined:"",dense:"",options:o.colegios,rules:[e=>!!e||"Campo requerido"],"emit-value":"","map-options":"","option-value":"id","option-label":"nombre"},null,8,["modelValue","options","rules"])]),n("div",oe,[l(i,{modelValue:o.student.phone,"onUpdate:modelValue":t[12]||(t[12]=e=>o.student.phone=e),type:"number",label:"Celular",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),n("div",se,[l(i,{modelValue:o.student.email,"onUpdate:modelValue":t[13]||(t[13]=e=>o.student.email=e),label:"email",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),n("div",de,[l(x,{modelValue:o.student.sex,"onUpdate:modelValue":t[14]||(t[14]=e=>o.student.sex=e),val:"M",label:"Masculino"},null,8,["modelValue"]),l(x,{modelValue:o.student.sex,"onUpdate:modelValue":t[15]||(t[15]=e=>o.student.sex=e),val:"F",label:"Femenino"},null,8,["modelValue"])])])]),_:1}),l(k,{align:"right"},{default:d(()=>[h(l(C,{flat:"",label:"Cancelar",loading:o.loading},null,8,["loading"]),[[v]]),l(C,{color:"primary",label:"Guardar",type:"submit",loading:o.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}var Ve=S(L,[["render",ne]]);export{Ve as default};
