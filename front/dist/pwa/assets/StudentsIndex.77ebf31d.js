import{Q as m}from"./QTooltip.3bdf63f4.js";import{_ as b,Q as V,R as C,S as n,T as o,U as u,Y as f,aD as a,am as _,aB as y,aA as g,V as d,W as x,b6 as h,aE as v,L as w,aF as Q}from"./index.f8ff3c95.js";import{Q as D,a as E,b as I,C as k}from"./ClosePopup.20bc2b8d.js";import{Q as U}from"./QSpace.017fde33.js";import{Q as q}from"./QPage.b0391766.js";import"./position-engine.462165d6.js";import"./format.d0971b8d.js";import"./QItem.26eb41e1.js";const A={name:"StudentsIndex.vue",data(){return{columns:[{name:"option",label:"Opciones",align:"left",field:l=>l.option},{name:"id",label:"ID",align:"left",field:l=>l.id},{name:"rut",label:"Rut",align:"left",field:l=>l.rut},{name:"name",label:"Nombre",align:"left",field:l=>l.name},{name:"birthdate",label:"Fecha de Nacimiento",align:"left",field:l=>l.birthdate},{name:"year_PIE",label:"A\xF1o PIE",align:"left",field:l=>l.year_PIE},{name:"course",label:"Curso",align:"left",field:l=>l.course},{name:"year",label:"A\xF1o",align:"left",field:l=>l.year},{name:"address",label:"Direcci\xF3n",align:"left",field:l=>l.address},{name:"phone",label:"Celular",align:"left",field:l=>l.phone}],loading:!1,students:[],student:{},studentDialog:!1,clienDialogHistory:!1,filter:"",passwordShow:!1}},mounted(){this.studentGet()},methods:{studentSave(){this.loading=!0,this.student.id?this.$axios.put(`students/${this.student.id}`,this.student).then(l=>{this.studentDialog=!1;const t=this.students.findIndex(i=>i.id===this.student.id);this.students.splice(t,1,l.data)}).catch(l=>{this.$alert.error(l.response.data.message)}).finally(()=>{this.loading=!1}):this.$axios.post("students",this.student).then(l=>{this.studentDialog=!1,this.students.unshift(l.data)}).catch(l=>{this.$alert.error(l.response.data.message)}).finally(()=>{this.loading=!1})},studentChangePassword(l){this.$alert.promptPassword("Ingrese la nueva contrase\xF1a").onOk(t=>{this.loading=!0,this.$axios.put(`passwordUpdate/${l.id}`,{password:t}).then(i=>{this.$alert.success("Contrase\xF1a cambiada con \xE9xito")}).catch(i=>{this.$alert.error(i.response.data.message)}).finally(()=>{this.loading=!1})})},studentHistory(l){this.$router.push("/students/history/"+l.id)},studentDelete(l){this.$alert.confirm("\xBFEst\xE1 seguro de eliminar este studente?").onOk(()=>{this.loading=!0,this.$axios.delete(`students/${l.id}`).then(t=>{const i=this.students.findIndex(c=>c.id===c.id);this.students.splice(i,1)}).catch(t=>{this.$alert.error(t.response.data.message)}).finally(()=>{this.loading=!1})})},studentEdit(l){this.studentDialog=!0,this.student={...l}},studentAdd(){this.studentDialog=!0,this.student={name:"",ci:"",birthdate:"",year_PIE:"",cource:"",year:"",address:"",phone:"",sex:"M"}},studentGet(){this.loading=!0,this.$axios.get("students").then(l=>{this.students=l.data}).catch(l=>{this.$alert.error(l.response.data.message)}).finally(()=>{this.loading=!1})}}},P={class:"text-h6"},S={class:"row"},N={class:"col-12 col-md-4"},B={class:"col-12 col-md-8"},F={class:"col-12 col-md-3"},T={class:"col-12 col-md-3"},H={class:"col-12 col-md-3"},R={class:"col-12 col-md-3"},G={class:"col-12"},M={class:"col-12 col-md-6"},O={class:"col-12 col-md-6"};function L(l,t,i,c,s,r){return V(),C(q,{class:"bg-grey-3 q-pa-md"},{default:n(()=>[o(E,{rows:s.students,columns:s.columns,title:"Clientes","rows-per-page-options":[0],"row-key":"id",dense:"",filter:s.filter,loading:s.loading},{"body-cell-option":n(e=>[o(D,{"auto-width":""},{default:n(()=>[o(u,{flat:"",dense:"",icon:"edit",onClick:p=>r.studentEdit(e.row)},{default:n(()=>[o(m,null,{default:n(()=>[f("Editar")]),_:1})]),_:2},1032,["onClick"]),o(u,{flat:"",dense:"",icon:"delete",onClick:p=>r.studentDelete(e.row)},{default:n(()=>[o(m,null,{default:n(()=>[f("Eliminar")]),_:1})]),_:2},1032,["onClick"]),o(u,{flat:"",dense:"",icon:"history",onClick:p=>r.studentHistory(e.row)},{default:n(()=>[o(m,null,{default:n(()=>[f("Historial")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),"top-right":n(()=>[o(u,{outline:"",dense:"",icon:"add_circle",onClick:r.studentAdd,label:"Agregar","no-caps":"",loading:s.loading},{default:n(()=>[o(m,null,{default:n(()=>[f("Agregar")]),_:1})]),_:1},8,["onClick","loading"]),o(a,{modelValue:s.filter,"onUpdate:modelValue":t[0]||(t[0]=e=>s.filter=e),dense:"",class:"q-ml-md",debounce:"300",placeholder:"Buscar",outlined:"",clearable:""},{append:n(()=>[o(_,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","columns","filter","loading"]),o(Q,{modelValue:s.studentDialog,"onUpdate:modelValue":t[12]||(t[12]=e=>s.studentDialog=e),persistent:""},{default:n(()=>[o(y,{style:{width:"750px","max-width":"90vw"}},{default:n(()=>[o(g,{class:"row items-center q-pb-none"},{default:n(()=>[d("div",P,x(s.student.id?"Editar":"Agregar")+" Estudiante",1),o(U),o(u,{flat:"",dense:"",icon:"close",onClick:t[1]||(t[1]=e=>s.studentDialog=!1)})]),_:1}),o(I,{onSubmit:r.studentSave},{default:n(()=>[o(g,null,{default:n(()=>[d("div",S,[d("div",N,[o(a,{modelValue:s.student.rut,"onUpdate:modelValue":t[2]||(t[2]=e=>s.student.rut=e),label:"Rut",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),d("div",B,[o(a,{modelValue:s.student.name,"onUpdate:modelValue":t[3]||(t[3]=e=>s.student.name=e),label:"Nombre Completo",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),d("div",F,[o(a,{modelValue:s.student.birthdate,"onUpdate:modelValue":t[4]||(t[4]=e=>s.student.birthdate=e),label:"Fecha de Nacimiento",type:"date",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),d("div",T,[o(a,{modelValue:s.student.year_PIE,"onUpdate:modelValue":t[5]||(t[5]=e=>s.student.year_PIE=e),label:"A\xF1o ingreso PIE",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),d("div",H,[o(a,{modelValue:s.student.course,"onUpdate:modelValue":t[6]||(t[6]=e=>s.student.course=e),label:"Curso",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),d("div",R,[o(a,{modelValue:s.student.year,"onUpdate:modelValue":t[7]||(t[7]=e=>s.student.year=e),label:"A\xF1o",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),d("div",G,[o(a,{modelValue:s.student.address,"onUpdate:modelValue":t[8]||(t[8]=e=>s.student.address=e),label:"Direcci\xF3n",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),d("div",M,[o(a,{modelValue:s.student.phone,"onUpdate:modelValue":t[9]||(t[9]=e=>s.student.phone=e),label:"Celular",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),d("div",O,[o(h,{modelValue:s.student.sex,"onUpdate:modelValue":t[10]||(t[10]=e=>s.student.sex=e),val:"M",label:"Masculino"},null,8,["modelValue"]),o(h,{modelValue:s.student.sex,"onUpdate:modelValue":t[11]||(t[11]=e=>s.student.sex=e),val:"F",label:"Femenino"},null,8,["modelValue"])])])]),_:1}),o(v,{align:"right"},{default:n(()=>[w(o(u,{flat:"",label:"Cancelar",loading:s.loading},null,8,["loading"]),[[k]]),o(u,{color:"primary",label:"Guardar",type:"submit",loading:s.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}var $=b(A,[["render",L]]);export{$ as default};
