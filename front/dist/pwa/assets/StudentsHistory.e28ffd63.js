import{_ as y,b7 as D,Q as h,R as m,S as t,T as s,aA as u,V as e,W as n,aB as _,U as v,b8 as p,am as Q,Y as g,Z as C,$ as k,a0 as I,a1 as P}from"./index.f8ff3c95.js";import{Q as F,a as S,b as q}from"./QSpace.017fde33.js";import{Q as x,a as f,b}from"./QItem.26eb41e1.js";import{Q as w}from"./QPage.b0391766.js";const U={name:"StudentsHistory",data(){return{student_id:this.$route.params.id,student:{},process:0,textProcess:"",loading:!1}},mounted(){this.student_id=this.$route.params.id,this.studentGet()},methods:{addHistory(){this.$q.dialog({component:()=>D(()=>import("./IndexPage.d4aa02e2.js"),["assets/IndexPage.d4aa02e2.js","assets/QPage.b0391766.js","assets/index.f8ff3c95.js","assets/index.ed0e09ba.css","assets/QTooltip.3bdf63f4.js","assets/position-engine.462165d6.js"]),parent:this,on:{submit:l=>{console.log(l)}}})},handleDrop(l){l.preventDefault();const o=l.dataTransfer.files;this.processFiles(o)},processFiles(l){this.fileUpload(l)},uploadFile(){this.$refs.fileInput.click()},fileUpload(){const l=new FormData;l.append("file",this.$refs.fileInput.files[0]),l.append("student_id",this.student_id);const o={onUploadProgress:i=>{const c=Math.round(i.loaded*100/i.total);this.textProcess=c+"% completado",this.process=c/100}};this.$axios.post(`students/${this.student_id}/diagnoses`,l,o).then(i=>{this.student.diagnoses.unshift(i.data)}).catch(i=>{this.$alert.error(i.response.data.message)}).finally(()=>{this.$refs.fileInput.value="",this.textProcess=""})},studentGet(){this.$axios.get(`students/${this.student_id}`).then(l=>{this.student=l.data}).catch(l=>{this.$alert.error(l.response.data.message)})},deleteDiagnosis(l){this.$alert.confirm("\xBFEst\xE1 seguro de eliminar este diagn\xF3stico?").onOk(()=>{this.loading=!0,this.$axios.delete(`diagnoses/${l}`).then(o=>{const i=this.student.diagnoses.findIndex(c=>c.id===l);this.student.diagnoses.splice(i,1)}).catch(o=>{this.$alert.error(o.response.data.message)}).finally(()=>{this.loading=!1})})}}},A={class:"row"},B={class:"col-12 col-md-3"},H=e("label",{class:"text-bold"},"Rut",-1),M={class:"col-12 col-md-9"},N=e("label",{class:"text-bold"},"Nombre Completo",-1),V={class:"col-6 col-md-3"},E=e("label",{class:"text-bold"},"Fecha de Nacimiento",-1),T={class:"col-6 col-md-3"},L=e("label",{class:"text-bold"},"A\xF1o ingreso PIE",-1),R={class:"col-6 col-md-3"},z=e("label",{class:"text-bold"},"Curso",-1),G={class:"col-6 col-md-3"},O=e("label",{class:"text-bold"},"A\xF1o",-1),Y={class:"col-12"},W=e("label",{class:"text-bold"},"Direcci\xF3n",-1),Z={class:"col-6 col-md-6"},j=e("label",{class:"text-bold"},"Celular",-1),J={class:"col-6 col-md-6"},K=e("label",{class:"text-bold"},"Sexo",-1),X={class:"row"},$={class:"col-12 col-md-8"},ee={class:"row items-center"},se=e("div",{class:"text-h6"},"Historial",-1),te=e("thead",null,[e("tr",null,[e("th",null,"Fecha"),e("th",null,"Descripci\xF3n"),e("th",null,"Usuario")])],-1),le={class:"col-12 col-md-4"},oe=e("div",{class:"text-h6"},"Diagn\xF3sticos",-1),de=e("div",null,"Ac\xE1 suba sus archivos",-1),ne={class:"q-mt-md"};function ae(l,o,i,c,d,r){return h(),m(w,{class:"bg-grey-3 q-pa-md"},{default:t(()=>[s(_,{class:"q-mb-md"},{default:t(()=>[s(u,null,{default:t(()=>[e("div",A,[e("div",B,[H,e("div",null,n(d.student.rut),1)]),e("div",M,[N,e("div",null,n(d.student.name),1)]),e("div",V,[E,e("div",null,n(d.student.birthdate),1)]),e("div",T,[L,e("div",null,n(d.student.year_PIE),1)]),e("div",R,[z,e("div",null,n(d.student.course),1)]),e("div",G,[O,e("div",null,n(d.student.year),1)]),e("div",Y,[W,e("div",null,n(d.student.address),1)]),e("div",Z,[j,e("div",null,n(d.student.phone),1)]),e("div",J,[K,e("div",null,n(d.student.sex==="M"?"Masculino":"Femenino"),1)])])]),_:1})]),_:1}),e("div",X,[e("div",$,[s(_,null,{default:t(()=>[s(u,null,{default:t(()=>[e("div",ee,[se,s(F),s(v,{icon:"add_circle_outline",onClick:r.addHistory,label:"Agregar","no-caps":"",color:"green",dense:"",size:"10px"},null,8,["onClick"])]),s(S,{dense:"","wrap-cells":""},{default:t(()=>[te]),_:1})]),_:1})]),_:1})]),e("div",le,[s(_,null,{default:t(()=>[s(u,null,{default:t(()=>[oe,e("div",{class:"text-center border-dashed cursor-pointer",onClick:o[0]||(o[0]=(...a)=>r.uploadFile&&r.uploadFile(...a)),onDragenter:o[1]||(o[1]=p(()=>{},["prevent"])),onDragover:o[2]||(o[2]=p(()=>{},["prevent"])),onDragleave:o[3]||(o[3]=p(()=>{},["prevent"])),onDrop:o[4]||(o[4]=p((...a)=>r.handleDrop&&r.handleDrop(...a),["prevent"]))},[s(Q,{name:"cloud_upload",size:"70px"}),de],32),e("input",{type:"file",class:"hidden",ref:"fileInput",onChange:o[5]||(o[5]=(...a)=>r.fileUpload&&r.fileUpload(...a)),accept:".pdf"},null,544),e("div",ne,[s(_,null,{default:t(()=>[s(u,{class:"q-pa-none"},{default:t(()=>[d.textProcess!==""?(h(),m(x,{key:0},{default:t(()=>[s(f,null,{default:t(()=>[s(b,null,{default:t(()=>[g(n(d.textProcess),1)]),_:1}),s(q,{value:d.process,color:d.process===100?"green":"primary"},null,8,["value","color"])]),_:1}),s(f,{side:""},{default:t(()=>[s(v,{flat:"",icon:"picture_as_pdf"})]),_:1})]),_:1})):C("",!0)]),_:1})]),_:1}),(h(!0),k(P,null,I(d.student.diagnoses,a=>(h(),m(_,{key:a.id,flat:"",bordered:"",class:"q-ma-sm"},{default:t(()=>[s(u,{class:"q-pa-none"},{default:t(()=>[s(x,null,{default:t(()=>[s(f,null,{default:t(()=>[s(b,null,{default:t(()=>[g(n(l.$filters.formatdMY(a.created_at)),1)]),_:2},1024),s(b,null,{default:t(()=>[g(n(a.name),1)]),_:2},1024)]),_:2},1024),s(f,{side:""},{default:t(()=>[s(v,{flat:"",icon:"delete",onClick:ie=>r.deleteDiagnosis(a.id),color:"red",loading:d.loading},null,8,["onClick","loading"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))])]),_:1})]),_:1})])]),e("pre",null,n(d.student),1)]),_:1})}var he=y(U,[["render",ae]]);export{he as default};
