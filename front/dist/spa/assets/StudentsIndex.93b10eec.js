import{Q as f}from"./QTooltip.5e6ffa9f.js";import{_ as v,Q as m,R as c,S as n,T as s,U as u,Y as p,Z as g,aD as a,am as y,aB as D,aA as C,V as d,W as w,b6 as x,aE as k,L as Q,aF as U}from"./index.8d94b7cb.js";import{Q as _,a as E,b as A,c as I,C as q}from"./ClosePopup.ba03cdb3.js";import{f as h}from"./format.aae4923e.js";import{Q as S}from"./QPage.662b9bf2.js";import"./position-engine.ad0ac3ed.js";const T={name:"StudentsIndex.vue",data(){return{columns:[{name:"option",label:"Opciones",align:"left",field:o=>o.option},{name:"id",label:"ID",align:"left",field:o=>o.id},{name:"name",label:"Nombre",align:"left",field:o=>o.name},{name:"studentname",label:"Usuario",align:"left",field:o=>o.studentname},{name:"role",label:"Rol",align:"left",field:o=>o.role}],loading:!1,students:[],student:{},studentDialog:!1,clienDialogHistory:!1,filter:"",passwordShow:!1}},mounted(){this.studentGet()},methods:{studentSave(){this.loading=!0,this.student.id?this.$axios.put(`students/${this.student.id}`,this.student).then(o=>{this.studentDialog=!1;const t=this.students.findIndex(i=>i.id===this.student.id);this.students.splice(t,1,o.data)}).catch(o=>{this.$alert.error(o.response.data.message)}).finally(()=>{this.loading=!1}):this.$axios.post("students",this.student).then(o=>{this.studentDialog=!1,this.students.unshift(o.data)}).catch(o=>{this.$alert.error(o.response.data.message)}).finally(()=>{this.loading=!1})},studentChangePassword(o){this.$alert.promptPassword("Ingrese la nueva contrase\xF1a").onOk(t=>{this.loading=!0,this.$axios.put(`passwordUpdate/${o.id}`,{password:t}).then(i=>{this.$alert.success("Contrase\xF1a cambiada con \xE9xito")}).catch(i=>{this.$alert.error(i.response.data.message)}).finally(()=>{this.loading=!1})})},studentDelete(o){this.$alert.confirm("\xBFEst\xE1 seguro de eliminar este studente?").onOk(()=>{this.loading=!0,this.$axios.delete(`students/${o.id}`).then(t=>{const i=this.students.findIndex(V=>V.id===V.id);this.students.splice(i,1)}).catch(t=>{this.$alert.error(t.response.data.message)}).finally(()=>{this.loading=!1})})},studentEdit(o){this.studentDialog=!0,this.student={...o}},studentAdd(){this.studentDialog=!0,this.student={name:"",ci:""}},studentGet(){this.loading=!0,this.$axios.get("students").then(o=>{this.students=o.data}).catch(o=>{this.$alert.error(o.response.data.message)}).finally(()=>{this.loading=!1})}}},N={class:"text-h6"},P={class:"row"},R={class:"col-12 col-md-4"},B={class:"col-12 col-md-8"},O={class:"col-12 col-md-3"},F={class:"col-12 col-md-3"},G={class:"col-12 col-md-3"},M={class:"col-12 col-md-3"},H={class:"col-12"},Y={class:"col-12 col-md-6"},L={class:"col-12 col-md-6"};function W(o,t,i,V,l,r){return m(),c(S,{class:"bg-grey-3 q-pa-md"},{default:n(()=>[s(E,{rows:l.students,columns:l.columns,title:"Clientes","rows-per-page-options":[0],"row-key":"id",dense:"",filter:l.filter,loading:l.loading},{"body-cell-option":n(e=>[s(_,{"auto-width":""},{default:n(()=>[s(u,{flat:"",dense:"",icon:"edit",onClick:b=>r.studentEdit(e.row)},{default:n(()=>[s(f,null,{default:n(()=>[p("Editar")]),_:1})]),_:2},1032,["onClick"]),s(u,{flat:"",dense:"",icon:"delete",onClick:b=>r.studentDelete(e.row)},{default:n(()=>[s(f,null,{default:n(()=>[p("Eliminar")]),_:1})]),_:2},1032,["onClick"]),s(u,{flat:"",dense:"",icon:"vpn_key",onClick:b=>r.studentChangePassword(e.row)},{default:n(()=>[s(f,null,{default:n(()=>[p("Cambiar Contrase\xF1a")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),"body-cell-role":n(e=>[s(_,{props:e},{default:n(()=>[e.row.role==="ADMIN"?(m(),c(h,{key:0,dense:"",label:"Admin",color:"primary","text-color":"white"})):g("",!0),e.row.role==="ATTORNEY"?(m(),c(h,{key:1,dense:"",label:"Tutor",color:"indigo","text-color":"white"})):g("",!0),e.row.role==="TEACHER"?(m(),c(h,{key:2,dense:"",label:"Profesor",color:"green","text-color":"white"})):g("",!0),e.row.role==="DOCTOR"?(m(),c(h,{key:3,dense:"",label:"Doctor",color:"red","text-color":"white"})):g("",!0)]),_:2},1032,["props"])]),"top-right":n(()=>[s(u,{outline:"",dense:"",icon:"add_circle",onClick:r.studentAdd,label:"Agregar","no-caps":"",loading:l.loading},{default:n(()=>[s(f,null,{default:n(()=>[p("Agregar")]),_:1})]),_:1},8,["onClick","loading"]),s(a,{modelValue:l.filter,"onUpdate:modelValue":t[0]||(t[0]=e=>l.filter=e),dense:"",class:"q-ml-md",debounce:"300",placeholder:"Buscar",outlined:"",clearable:""},{append:n(()=>[s(y,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","columns","filter","loading"]),s(U,{modelValue:l.studentDialog,"onUpdate:modelValue":t[12]||(t[12]=e=>l.studentDialog=e),persistent:""},{default:n(()=>[s(D,{style:{width:"750px","max-width":"90vw"}},{default:n(()=>[s(C,{class:"row items-center q-pb-none"},{default:n(()=>[d("div",N,w(l.student.id?"Editar":"Agregar")+" Estudiante",1),s(A),s(u,{flat:"",dense:"",icon:"close",onClick:t[1]||(t[1]=e=>l.studentDialog=!1)})]),_:1}),s(I,{onSubmit:r.studentSave},{default:n(()=>[s(C,null,{default:n(()=>[d("div",P,[d("div",R,[s(a,{modelValue:l.student.rut,"onUpdate:modelValue":t[2]||(t[2]=e=>l.student.rut=e),label:"Rut",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),d("div",B,[s(a,{modelValue:l.student.name,"onUpdate:modelValue":t[3]||(t[3]=e=>l.student.name=e),label:"Nombre Completo",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),d("div",O,[s(a,{modelValue:l.student.birthdate,"onUpdate:modelValue":t[4]||(t[4]=e=>l.student.birthdate=e),label:"Fecha de Nacimiento",type:"date",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),d("div",F,[s(a,{modelValue:l.student.year_PIE,"onUpdate:modelValue":t[5]||(t[5]=e=>l.student.year_PIE=e),label:"A\xF1o ingreso PIE",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),d("div",G,[s(a,{modelValue:l.student.course,"onUpdate:modelValue":t[6]||(t[6]=e=>l.student.course=e),label:"Curso",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),d("div",M,[s(a,{modelValue:l.student.year,"onUpdate:modelValue":t[7]||(t[7]=e=>l.student.year=e),label:"A\xF1o",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),d("div",H,[s(a,{modelValue:l.student.address,"onUpdate:modelValue":t[8]||(t[8]=e=>l.student.address=e),label:"Direcci\xF3n",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),d("div",Y,[s(a,{modelValue:l.student.phone,"onUpdate:modelValue":t[9]||(t[9]=e=>l.student.phone=e),label:"Celular",outlined:"",dense:"",rules:[e=>!!e||"Campo requerido"]},null,8,["modelValue","rules"])]),d("div",L,[s(x,{modelValue:l.student.sex,"onUpdate:modelValue":t[10]||(t[10]=e=>l.student.sex=e),val:"M",label:"Masculino"},null,8,["modelValue"]),s(x,{modelValue:l.student.sex,"onUpdate:modelValue":t[11]||(t[11]=e=>l.student.sex=e),val:"F",label:"Femenino"},null,8,["modelValue"])]),d("pre",null,w(l.student),1)])]),_:1}),s(k,{align:"right"},{default:n(()=>[Q(s(u,{flat:"",label:"Cancelar",loading:l.loading},null,8,["loading"]),[[q]]),s(u,{color:"primary",label:"Guardar",type:"submit",loading:l.loading},null,8,["loading"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}var $=v(T,[["render",W]]);export{$ as default};
